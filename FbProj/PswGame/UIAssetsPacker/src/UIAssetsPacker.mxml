<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/mx">
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			private const numRects:int = 100;
			private const minW:uint = 10;
			private const minH:uint = 10;
			private const interval:uint = 400;
			
			private var rects:Vector.<BitmapData>;
			
			private var configuration:Vector.<Rectangle>;
			private var conW:uint;
			private var conH:uint;
			private var area:uint;
			
			private function init():void
			{
				randomizeRects();
				//初始化格局
				configuration = new Vector.<Rectangle>();
				configuration.push(new Rectangle());
				conW = Math.sqrt(area);
				configuration.push(new Rectangle(conW,0,0,0));
				
				pack();
			}
			
			private function randomizeRects():void
			{
				rects = new Vector.<BitmapData>();
				for(var i:int=0;i<numRects;++i)
				{
					var rect:BitmapData = new BitmapData( minW + Math.random() * interval,
														minH + Math.random() * interval,true,
														0xFFFFFFFF * Math.random());
					rects.push(rect);
					area += rect.rect.width * rect.rect.height;
				}
			}
			
			private function pack():void
			{
				var isAngleExist:Boolean = true;//是否存在可用的占角
				while(isAngleExist && rects.length > 0)
				{
					sortConfiguration();
					var curAngle:Rectangle = configuration.shift();
					for(var i:int=0;i<rects.length;++i)
					{
						var r:Rectangle = new Rectangle();
						r.x= curAngle.x;
						r.y= curAngle.y;
						r.width = rects[i].width;
						r.height = rects[i].height;
//						if()
					}
				}
			}
			
			private function sortConfiguration():void
			{
				configuration.sort(function(A:Rectangle,B:Rectangle):Number
				{
					if(A.y < B.y)
					{
						if(A.x < B.x)
						{
							return 1;
						}
						return -1;
					}
					else if(A.y > B.y)
					{
						return 1;
					}
					else
					{
						return 0;
					}
				});
			}
			
		]]>
	</fx:Script>
</s:WindowedApplication>
